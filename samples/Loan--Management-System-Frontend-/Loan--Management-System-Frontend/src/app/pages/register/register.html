<div class="container">
  <form [formGroup]="registerForm" (ngSubmit)="handleRegister()">

    <h1>Create Account</h1>

    <!-- EMAIL -->
    <input
      type="email"
      formControlName="email"
      placeholder="Email"
    />
    <div class="error" *ngIf="registerForm.get('email')?.touched">
      <span *ngIf="registerForm.get('email')?.hasError('required')">
        Email is required
      </span>
      <span *ngIf="registerForm.get('email')?.hasError('email')">
        Enter a valid email address
      </span>
    </div>

    <!-- USERNAME -->
    <input
      type="text"
      formControlName="username"
      placeholder="Username"
    />
    <div class="error" *ngIf="registerForm.get('username')?.touched">
      <span *ngIf="registerForm.get('username')?.hasError('required')">
        Username is required
      </span>
      <span *ngIf="registerForm.get('username')?.hasError('minlength')">
        Minimum 4 characters required
      </span>
      <span *ngIf="registerForm.get('username')?.hasError('maxlength')">
        Maximum 20 characters allowed
      </span>
      <span *ngIf="registerForm.get('username')?.hasError('pattern')">
        Only letters, numbers and underscore (_) allowed
      </span>

      <!-- âœ… NEW -->
      <span *ngIf="registerForm.get('username')?.hasError('usernameExists')">
        Username already exists
      </span>
    </div>

    <!-- PASSWORD -->
    <input
      type="password"
      formControlName="password"
      placeholder="Password"
    />
    <div class="error" *ngIf="registerForm.get('password')?.touched">
      <span *ngIf="registerForm.get('password')?.hasError('required')">
        Password is required
      </span>
      <span *ngIf="registerForm.get('password')?.hasError('minlength')">
        Minimum 8 characters required
      </span>
      <span *ngIf="registerForm.get('password')?.hasError('pattern')">
        Must include uppercase, lowercase, number & special character
      </span>
    </div>

    <!-- SUBMIT -->
    <button
      type="submit"
      [disabled]="registerForm.invalid || isSubmitting">
      {{ isSubmitting ? 'Registering...' : 'Register' }}
    </button>

    <!-- FOOTER -->
    <p>
      Already have an account?
      <a (click)="goToLogin()">Login</a>
    </p>

  </form>
</div>
